#  프로그램이 실행되었지만, 뭐가 뭔지 하나도 모르겠다.

## 2.1 운영체제, 프로세스, 스레드의 근본 이해하기

CPU는 스레드, 프로세스, 운영체제같은 개념을 알지 못하며, 단지 `메모리에서 명령어(instruction)를 하나 가져오고(dispatch), 실행(execute)을 반복`할 뿐이다.

PC 레지스터(program counter register)는 CPU가 현재 실행 중인 명령어의 주소를 저장한다. 그리고 이 주소를 기준으로 다음 명령어를 가져오기 위해 PC레지스터의 값을 증가시킨다.

작성하는 프로그램의 시작점은 `main함수`이다.  

> CPU는 한번에 한가지 일만 할수 있지만, 여러 프로그램 사이를 빠르게 전환함에 따라, 동시에 실행되는 것처럼 보이게 한다.

---
### 프로세스(process)

`프로세스`는 상황 정보(context)를 저장하고, 프로그램의 필요한 정보를 기록할 수 있는 구조체이다.

프로그램을 자동으로 적재해주고 멀티태스킹을 실현해주는 프로세스 관리 도구를 `운영체제(OS)`라고 한다.

![Process Address](./src/section02/process_address.png)

코드 영역(code segment) - 텍스트 영역 : 코드를 컴파일하여 생성된 기계 명령어가 저장

데이터 영역(data segment) : 전역 변수등이 저장

스택 영역(stack segment) : 프로그램이 자동으로 사용하는 임시 메모리 영역. 
함수 호출 시 생성되는 지역 변수와 매개 변수가 저장되는 영역이고, 함수 호출이 완료되면 사라진다. 

힙 영역(heap segment) : 힙 영역은 프로그래머가 직접 공간을 할당, 해제하는 메모리 공간(혹은 Garbage Collector가 대신 처리해준다)  힙 영역은 선입선출(FIFO, First-In First-Out)의 방식으로, 가장 먼저 들어온 데이터가 가장 먼저 인출

### 다중 프로세스

운영체제(OS)가 동시에 여러 개의 프로세스를 실행하고 관리하는 방식  
프로세스 간 통신(IPC: Inter-Process Communication) 기법을 사용해 데이터를 주고받을 수 있음.

#### 다중 프로세스의 단점
1. 프로세스를 생성할 때 큰 부담(overhead)가 걸림
2. 프로세스마다 자체적인 주소 공간을 가지고 있음에 따라, 프로세스간 통신은 프로그래밍하기에 더 복잡함.

---

### 스레드(thread)

![Thread](./src/section02/thread.png)

하나의 프로세스 안에서 여러 실행 흐름을 가지는 방식

스레드는 프로세스 주소 공간을 공유하여 프로세스보다 훨씬 가볍고 생성 속도가 빠르다.

> 스레드를 `경량 프로세스(light weight process - LWP)`라고도 함.

#### 스레드의 활용

스레드가 처리하는 작업에는 긴 작업(long task)와 짧은 작업(short task)가 있음.

1. 긴 작업 : 매우 긴 시간동안 활동하는 작업
    예) 대용량 파일 읽기/쓰기, 네트워크 요청/응답 대기 (예: 서버에 API 호출), 데이터베이스 질의 실행, 복잡한 이미지 처리, 대규모 연산 (영상 인코딩, 머신러닝 학습 등)

2. 짧은 작업 : 매우 짧은 시간동안 활동하는 작업
    예) 변수 계산, 단순한 수식 처리, GUI 요소 그리기, 버튼 클릭 이벤트 처리, 리스트 정렬이나 필터링 같은 소규모 데이터 처리, 사용자 입력 검증

#### 스레드 풀(thread pool)

> 스레드의 생성과 종료에 많은 시간을 허비하고 리소스를 많이 소비함.  
> 스레드 수가 많으면 스레드 간 전환에 부담이 증가

이에 따라, 스레드 풀이 탄생함.

스레드를 여러개 미리 생성해두고, 스레드가 처리할 작업이 생기면 해당 스레드에 처리를 요청하는 것.  
스레드 여러개가 미리 생성되어 있어 스레스 생성/종료 작업이 빈번하게 발생하지 않고 일정하게 관리됨에 따라 불필요한 메모리 소비가 없음.

![생산자와 소비자 스레드](./src/section02/thread_pool_producer_consumer_pattern.png)

`Queue` 형태로 작업이 저장되어 있고, 스레드가 작업을 처리함.

#### 다중 스레드(multi-threading)

스레드 여러 개를 생성하기만 하면 다중 코어를 이용하여 CPU를 최대한 활용할 수 있다.


---

## 스레드 간 공유되는 프로세스 리소스

